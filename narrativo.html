<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de GestiÃ³n de Proyectos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 24px;
            border: none;
            background: #f0f0f0;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #666;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 5px solid #667eea;
        }

        .form-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .data-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .data-table tr:hover {
            background: #f8f9ff;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-top: 4px solid #667eea;
        }

        .stat-card h4 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .stat-card p {
            color: #666;
            font-weight: 500;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }

        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 10px;
            font-weight: 500;
        }

        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .alert-info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .nav-tabs {
                justify-content: center;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸš€ Sistema de GestiÃ³n de Proyectos</h1>
            <p>Gestiona personas, proyectos, actividades y tareas con seguimiento mensual</p>
        </div>

        <div class="nav-tabs">
            <button class="tab-button active" onclick="showTab('personas')">ðŸ‘¥ Personas</button>
            <button class="tab-button" onclick="showTab('proyectos')">ðŸ“Š Proyectos</button>
            <button class="tab-button" onclick="showTab('actividades')">ðŸ“‹ Actividades</button>
            <button class="tab-button" onclick="showTab('tareas')">âœ… Tareas</button>
            <button class="tab-button" onclick="showTab('registro')">ðŸ“ˆ Registro Mensual</button>
            <button class="tab-button" onclick="showTab('dashboard')">ðŸ“Š Dashboard</button>
        </div>

        <!-- Tab Personas -->
        <div id="personas" class="tab-content active">
            <div class="form-section">
                <h3>Registrar Nueva Persona</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nombrePersona">Nombre Completo:</label>
                        <input type="text" id="nombrePersona" placeholder="Ej: Juan PÃ©rez">
                    </div>
                    <div class="form-group">
                        <label for="cargoPersona">Cargo:</label>
                        <input type="text" id="cargoPersona" placeholder="Ej: Supervisor">
                    </div>
                    <div class="form-group">
                        <label for="emailPersona">Email:</label>
                        <input type="email" id="emailPersona" placeholder="juan@ejemplo.com">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="agregarPersona()">Agregar Persona</button>
            </div>

            <div class="form-section">
                <h3>Lista de Personas</h3>
                <table class="data-table" id="tablaPersonas">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Cargo</th>
                            <th>Email</th>
                            <th>Proyectos</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Tab Proyectos -->
        <div id="proyectos" class="tab-content">
            <div class="form-section">
                <h3>Registrar Nuevo Proyecto</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nombreProyecto">Nombre del Proyecto:</label>
                        <input type="text" id="nombreProyecto" placeholder="Ej: Control de Calidad">
                    </div>
                    <div class="form-group">
                        <label for="personaResponsable">Persona Responsable:</label>
                        <select id="personaResponsable"></select>
                    </div>
                    <div class="form-group">
                        <label for="descripcionProyecto">DescripciÃ³n:</label>
                        <input type="text" id="descripcionProyecto" placeholder="DescripciÃ³n del proyecto">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="agregarProyecto()">Agregar Proyecto</button>
            </div>

            <div class="form-section">
                <h3>Lista de Proyectos</h3>
                <table class="data-table" id="tablaProyectos">
                    <thead>
                        <tr>
                            <th>Proyecto</th>
                            <th>Responsable</th>
                            <th>DescripciÃ³n</th>
                            <th>Actividades</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Tab Actividades -->
        <div id="actividades" class="tab-content">
            <div class="form-section">
                <h3>Registrar Nueva Actividad</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nombreActividad">Nombre de la Actividad:</label>
                        <input type="text" id="nombreActividad" placeholder="Ej: Control de Sentencias de Librado">
                    </div>
                    <div class="form-group">
                        <label for="proyectoActividad">Proyecto:</label>
                        <select id="proyectoActividad"></select>
                    </div>
                    <div class="form-group">
                        <label for="metaMensual">Meta Mensual:</label>
                        <input type="number" id="metaMensual" placeholder="Ej: 50">
                    </div>
                    <div class="form-group">
                        <label for="metaAnual">Meta Anual:</label>
                        <input type="number" id="metaAnual" placeholder="Ej: 600">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="agregarActividad()">Agregar Actividad</button>
            </div>

            <div class="form-section">
                <h3>Lista de Actividades</h3>
                <table class="data-table" id="tablaActividades">
                    <thead>
                        <tr>
                            <th>Actividad</th>
                            <th>Proyecto</th>
                            <th>Meta Mensual</th>
                            <th>Meta Anual</th>
                            <th>Tareas</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Tab Tareas -->
        <div id="tareas" class="tab-content">
            <div class="form-section">
                <h3>Registrar Nueva Tarea</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nombreTarea">Nombre de la Tarea:</label>
                        <input type="text" id="nombreTarea" placeholder="Ej: RevisiÃ³n de expedientes">
                    </div>
                    <div class="form-group">
                        <label for="actividadTarea">Actividad:</label>
                        <select id="actividadTarea"></select>
                    </div>
                    <div class="form-group">
                        <label for="descripcionTarea">DescripciÃ³n:</label>
                        <input type="text" id="descripcionTarea" placeholder="DescripciÃ³n de la tarea">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="agregarTarea()">Agregar Tarea</button>
            </div>

            <div class="form-section">
                <h3>Lista de Tareas</h3>
                <table class="data-table" id="tablaTareas">
                    <thead>
                        <tr>
                            <th>Tarea</th>
                            <th>Actividad</th>
                            <th>Proyecto</th>
                            <th>DescripciÃ³n</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Tab Registro Mensual -->
        <div id="registro" class="tab-content">
            <div class="form-section">
                <h3>Registro de Cumplimiento Mensual</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="personaRegistro">Persona:</label>
                        <select id="personaRegistro" onchange="cargarTareasPersona()"></select>
                    </div>
                    <div class="form-group">
                        <label for="mesRegistro">Mes:</label>
                        <select id="mesRegistro">
                            <option value="1">Enero</option>
                            <option value="2">Febrero</option>
                            <option value="3">Marzo</option>
                            <option value="4">Abril</option>
                            <option value="5">Mayo</option>
                            <option value="6">Junio</option>
                            <option value="7">Julio</option>
                            <option value="8">Agosto</option>
                            <option value="9">Septiembre</option>
                            <option value="10">Octubre</option>
                            <option value="11">Noviembre</option>
                            <option value="12">Diciembre</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="anoRegistro">AÃ±o:</label>
                        <input type="number" id="anoRegistro" value="2024" min="2020" max="2030">
                    </div>
                </div>
                <div id="tareasRegistro"></div>
                <button class="btn btn-success" onclick="guardarRegistroMensual()">Guardar Registro</button>
            </div>

            <div class="form-section">
                <h3>Registros Guardados</h3>
                <div id="registrosGuardados"></div>
            </div>
        </div>

        <!-- Tab Dashboard -->
        <div id="dashboard" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <h4 id="totalPersonas">0</h4>
                    <p>Total Personas</p>
                </div>
                <div class="stat-card">
                    <h4 id="totalProyectos">0</h4>
                    <p>Total Proyectos</p>
                </div>
                <div class="stat-card">
                    <h4 id="totalActividades">0</h4>
                    <p>Total Actividades</p>
                </div>
                <div class="stat-card">
                    <h4 id="totalTareas">0</h4>
                    <p>Total Tareas</p>
                </div>
            </div>

            <div class="form-section">
                <h3>Resumen por Persona</h3>
                <div id="resumenPersonas"></div>
            </div>
        </div>

        <div id="mensajes"></div>
    </div>

    <script>
        // Variables globales para almacenar datos
        let personas = [];
        let proyectos = [];
        let actividades = [];
        let tareas = [];
        let registrosMensuales = [];

        // FunciÃ³n para mostrar pestaÃ±as
        function showTab(tabName) {
            // Ocultar todas las pestaÃ±as
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Mostrar la pestaÃ±a seleccionada
            document.getElementById(tabName).classList.add('active');

            // Actualizar botones
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Actualizar datos dinÃ¡micos
            if (tabName === 'dashboard') {
                actualizarDashboard();
            }
        }

        // Funciones para personas
        function agregarPersona() {
            const nombre = document.getElementById('nombrePersona').value;
            const cargo = document.getElementById('cargoPersona').value;
            const email = document.getElementById('emailPersona').value;

            if (!nombre || !cargo || !email) {
                mostrarMensaje('Por favor complete todos los campos', 'error');
                return;
            }

            const persona = {
                id: Date.now(),
                nombre: nombre,
                cargo: cargo,
                email: email,
                proyectos: []
            };

            personas.push(persona);
            mostrarMensaje('Persona agregada exitosamente', 'success');
            limpiarFormularioPersona();
            actualizarTablaPersonas();
            actualizarSelectPersonas();
        }

        function limpiarFormularioPersona() {
            document.getElementById('nombrePersona').value = '';
            document.getElementById('cargoPersona').value = '';
            document.getElementById('emailPersona').value = '';
        }

        function actualizarTablaPersonas() {
            const tbody = document.querySelector('#tablaPersonas tbody');
            tbody.innerHTML = '';

            personas.forEach(persona => {
                const tr = document.createElement('tr');
                const proyectosPersona = proyectos.filter(p => p.personaId === persona.id);
                
                tr.innerHTML = `
                    <td>${persona.nombre}</td>
                    <td>${persona.cargo}</td>
                    <td>${persona.email}</td>
                    <td>${proyectosPersona.length}/3</td>
                    <td>
                        <button class="btn btn-danger" onclick="eliminarPersona(${persona.id})">Eliminar</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function eliminarPersona(id) {
            if (confirm('Â¿EstÃ¡ seguro de eliminar esta persona?')) {
                personas = personas.filter(p => p.id !== id);
                proyectos = proyectos.filter(p => p.personaId !== id);
                actualizarTablaPersonas();
                actualizarSelectPersonas();
                mostrarMensaje('Persona eliminada exitosamente', 'success');
            }
        }

        function actualizarSelectPersonas() {
            const selectResponsable = document.getElementById('personaResponsable');
            const selectRegistro = document.getElementById('personaRegistro');
            
            [selectResponsable, selectRegistro].forEach(select => {
                select.innerHTML = '<option value="">Seleccionar persona...</option>';
                personas.forEach(persona => {
                    select.innerHTML += `<option value="${persona.id}">${persona.nombre}</option>`;
                });
            });
        }

        // Funciones para proyectos
        function agregarProyecto() {
            const nombre = document.getElementById('nombreProyecto').value;
            const personaId = parseInt(document.getElementById('personaResponsable').value);
            const descripcion = document.getElementById('descripcionProyecto').value;

            if (!nombre || !personaId || !descripcion) {
                mostrarMensaje('Por favor complete todos los campos', 'error');
                return;
            }

            // Verificar que la persona no tenga mÃ¡s de 3 proyectos
            const proyectosPersona = proyectos.filter(p => p.personaId === personaId);
            if (proyectosPersona.length >= 3) {
                mostrarMensaje('Esta persona ya tiene 3 proyectos asignados', 'error');
                return;
            }

            const proyecto = {
                id: Date.now(),
                nombre: nombre,
                personaId: personaId,
                descripcion: descripcion,
                actividades: []
            };

            proyectos.push(proyecto);
            mostrarMensaje('Proyecto agregado exitosamente', 'success');
            limpiarFormularioProyecto();
            actualizarTablaProyectos();
            actualizarSelectProyectos();
            actualizarTablaPersonas();
        }

        function limpiarFormularioProyecto() {
            document.getElementById('nombreProyecto').value = '';
            document.getElementById('personaResponsable').value = '';
            document.getElementById('descripcionProyecto').value = '';
        }

        function actualizarTablaProyectos() {
            const tbody = document.querySelector('#tablaProyectos tbody');
            tbody.innerHTML = '';

            proyectos.forEach(proyecto => {
                const persona = personas.find(p => p.id === proyecto.personaId);
                const actividadesProyecto = actividades.filter(a => a.proyectoId === proyecto.id);
                
                tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${proyecto.nombre}</td>
                    <td>${persona ? persona.nombre : 'Sin asignar'}</td>
                    <td>${proyecto.descripcion}</td>
                    <td>${actividadesProyecto.length}/3</td>
                    <td>
                        <button class="btn btn-danger" onclick="eliminarProyecto(${proyecto.id})">Eliminar</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function eliminarProyecto(id) {
            if (confirm('Â¿EstÃ¡ seguro de eliminar este proyecto?')) {
                proyectos = proyectos.filter(p => p.id !== id);
                actividades = actividades.filter(a => a.proyectoId !== id);
                actualizarTablaProyectos();
                actualizarSelectProyectos();
                mostrarMensaje('Proyecto eliminado exitosamente', 'success');
            }
        }

        function actualizarSelectProyectos() {
            const select = document.getElementById('proyectoActividad');
            select.innerHTML = '<option value="">Seleccionar proyecto...</option>';
            proyectos.forEach(proyecto => {
                select.innerHTML += `<option value="${proyecto.id}">${proyecto.nombre}</option>`;
            });
        }

        // Funciones para actividades
        function agregarActividad() {
            const nombre = document.getElementById('nombreActividad').value;
            const proyectoId = parseInt(document.getElementById('proyectoActividad').value);
            const metaMensual = parseInt(document.getElementById('metaMensual').value);
            const metaAnual = parseInt(document.getElementById('metaAnual').value);

            if (!nombre || !proyectoId || !metaMensual || !metaAnual) {
                mostrarMensaje('Por favor complete todos los campos', 'error');
                return;
            }

            // Verificar que el proyecto no tenga mÃ¡s de 3 actividades
            const actividadesProyecto = actividades.filter(a => a.proyectoId === proyectoId);
            if (actividadesProyecto.length >= 3) {
                mostrarMensaje('Este proyecto ya tiene 3 actividades asignadas', 'error');
                return;
            }

            const actividad = {
                id: Date.now(),
                nombre: nombre,
                proyectoId: proyectoId,
                metaMensual: metaMensual,
                metaAnual: metaAnual,
                tareas: []
            };

            actividades.push(actividad);
            mostrarMensaje('Actividad agregada exitosamente', 'success');
            limpiarFormularioActividad();
            actualizarTablaActividades();
            actualizarSelectActividades();
            actualizarTablaProyectos();
        }

        function limpiarFormularioActividad() {
            document.getElementById('nombreActividad').value = '';
            document.getElementById('proyectoActividad').value = '';
            document.getElementById('metaMensual').value = '';
            document.getElementById('metaAnual').value = '';
        }

        function actualizarTablaActividades() {
            const tbody = document.querySelector('#tablaActividades tbody');
            tbody.innerHTML = '';

            actividades.forEach(actividad => {
                const proyecto = proyectos.find(p => p.id === actividad.proyectoId);
                const tareasActividad = tareas.filter(t => t.actividadId === actividad.id);
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${actividad.nombre}</td>
                    <td>${proyecto ? proyecto.nombre : 'Sin asignar'}</td>
                    <td>${actividad.metaMensual}</td>
                    <td>${actividad.metaAnual}</td>
                    <td>${tareasActividad.length}/4</td>
                    <td>
                        <button class="btn btn-danger" onclick="eliminarActividad(${actividad.id})">Eliminar</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function eliminarActividad(id) {
            if (confirm('Â¿EstÃ¡ seguro de eliminar esta actividad?')) {
                actividades = actividades.filter(a => a.id !== id);
                tareas = tareas.filter(t => t.actividadId !== id);
                actualizarTablaActividades();
                actualizarSelectActividades();
                mostrarMensaje('Actividad eliminada exitosamente', 'success');
            }
        }

        function actualizarSelectActividades() {
            const select = document.getElementById('actividadTarea');
            select.innerHTML = '<option value="">Seleccionar actividad...</option>';
            actividades.forEach(actividad => {
                select.innerHTML += `<option value="${actividad.id}">${actividad.nombre}</option>`;
            });
        }

        // Funciones para tareas
        function agregarTarea() {
            const nombre = document.getElementById('nombreTarea').value;
            const actividadId = parseInt(document.getElementById('actividadTarea').value);
            const descripcion = document.getElementById('descripcionTarea').value;

            if (!nombre || !actividadId || !descripcion) {
                mostrarMensaje('Por favor complete todos los campos', 'error');
                return;
            }

            // Verificar que la actividad no tenga mÃ¡s de 4 tareas
            const tareasActividad = tareas.filter(t => t.actividadId === actividadId);
            if (tareasActividad.length >= 4) {
                mostrarMensaje('Esta actividad ya tiene 4 tareas asignadas', 'error');
                return;
            }

            const tarea = {
                id: Date.now(),
                nombre: nombre,
                actividadId: actividadId,
                descripcion: descripcion
            };

            tareas.push(tarea);
            mostrarMensaje('Tarea agregada exitosamente', 'success');
            limpiarFormularioTarea();
            actualizarTablaTareas();
            actualizarTablaActividades();
        }

        function limpiarFormularioTarea() {
            document.getElementById('nombreTarea').value = '';
            document.getElementById('actividadTarea').value = '';
            document.getElementById('descripcionTarea').value = '';
        }

                function actualizarTablaTareas() {
            const tbody = document.querySelector('#tablaTareas tbody');
            tbody.innerHTML = '';

            tareas.forEach(tarea => {
                const actividad = actividades.find(a => a.id === tarea.actividadId);
                const proyecto = actividad ? proyectos.find(p => p.id === actividad.proyectoId) : null;

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${tarea.nombre}</td>
                    <td>${actividad ? actividad.nombre : 'Sin asignar'}</td>
                    <td>${proyecto ? proyecto.nombre : 'Sin asignar'}</td>
                    <td>${tarea.descripcion}</td>
                    <td>
                        <button class="btn btn-danger" onclick="eliminarTarea(${tarea.id})">Eliminar</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function eliminarTarea(id) {
            if (confirm('Â¿EstÃ¡ seguro de eliminar esta tarea?')) {
                tareas = tareas.filter(t => t.id !== id);
                actualizarTablaTareas();
                actualizarTablaActividades();
                mostrarMensaje('Tarea eliminada exitosamente', 'success');
            }
        }

        // Registro mensual
        function cargarTareasPersona() {
            const personaId = parseInt(document.getElementById('personaRegistro').value);
            const contenedor = document.getElementById('tareasRegistro');
            contenedor.innerHTML = '';

            if (!personaId) return;

            // Obtener proyectos de esa persona
            const proyectosPersona = proyectos.filter(p => p.personaId === personaId);
            // Obtener tareas relacionadas
            const tareasPersona = tareas.filter(t => {
                const actividad = actividades.find(a => a.id === t.actividadId);
                return actividad && proyectosPersona.some(p => p.id === actividad.proyectoId);
            });

            if (tareasPersona.length === 0) {
                contenedor.innerHTML = '<p>No hay tareas asignadas a esta persona.</p>';
                return;
            }

            tareasPersona.forEach(t => {
                const actividad = actividades.find(a => a.id === t.actividadId);
                const proyecto = proyectos.find(p => p.id === actividad.proyectoId);
                const div = document.createElement('div');
                div.classList.add('form-group');
                div.innerHTML = `
                    <label>${t.nombre} (${proyecto.nombre} - ${actividad.nombre})</label>
                    <input type="number" id="tareaCumplimiento-${t.id}" placeholder="Cumplimiento en el mes">
                `;
                contenedor.appendChild(div);
            });
        }

        function guardarRegistroMensual() {
            const personaId = parseInt(document.getElementById('personaRegistro').value);
            const mes = parseInt(document.getElementById('mesRegistro').value);
            const ano = parseInt(document.getElementById('anoRegistro').value);

            if (!personaId || !mes || !ano) {
                mostrarMensaje('Debe seleccionar persona, mes y aÃ±o', 'error');
                return;
            }

            const registros = [];
            tareas.forEach(t => {
                const input = document.getElementById(`tareaCumplimiento-${t.id}`);
                if (input) {
                    registros.push({
                        tareaId: t.id,
                        cumplimiento: parseInt(input.value) || 0
                    });
                }
            });

            registrosMensuales.push({
                id: Date.now(),
                personaId,
                mes,
                ano,
                registros
            });

            mostrarMensaje('Registro mensual guardado exitosamente', 'success');
            mostrarRegistrosGuardados();
        }

        function mostrarRegistrosGuardados() {
            const contenedor = document.getElementById('registrosGuardados');
            contenedor.innerHTML = '';

            registrosMensuales.forEach(r => {
                const persona = personas.find(p => p.id === r.personaId);
                const div = document.createElement('div');
                div.classList.add('alert', 'alert-info');
                div.innerHTML = `
                    <strong>${persona ? persona.nombre : 'Desconocido'}</strong> - ${r.mes}/${r.ano}
                    <br> Tareas registradas: ${r.registros.length}
                `;
                contenedor.appendChild(div);
            });
        }

        // Dashboard
        function actualizarDashboard() {
            document.getElementById('totalPersonas').innerText = personas.length;
            document.getElementById('totalProyectos').innerText = proyectos.length;
            document.getElementById('totalActividades').innerText = actividades.length;
            document.getElementById('totalTareas').innerText = tareas.length;

            const contenedor = document.getElementById('resumenPersonas');
            contenedor.innerHTML = '';

            personas.forEach(p => {
                const proyectosPersona = proyectos.filter(pr => pr.personaId === p.id);
                const actividadesPersona = actividades.filter(a => proyectosPersona.some(pr => pr.id === a.proyectoId));
                const tareasPersona = tareas.filter(t => actividadesPersona.some(a => a.id === t.actividadId));

                const div = document.createElement('div');
                div.classList.add('alert', 'alert-success');
                div.innerHTML = `
                    <strong>${p.nombre}</strong> <br>
                    Proyectos: ${proyectosPersona.length}, 
                    Actividades: ${actividadesPersona.length}, 
                    Tareas: ${tareasPersona.length}
                `;
                contenedor.appendChild(div);
            });
        }

        // Mensajes
        function mostrarMensaje(texto, tipo) {
            const div = document.createElement('div');
            div.classList.add('alert');
            if (tipo === 'success') div.classList.add('alert-success');
            else div.classList.add('alert-info');
            div.innerText = texto;

            const contenedor = document.getElementById('mensajes');
            contenedor.innerHTML = '';
            contenedor.appendChild(div);

            setTimeout(() => {
                div.remove();
            }, 3000);
        }
    </script>
</body>
</html>
